# 图神经网络
[toc]

## 第一天:图学习初印象

![image-20201123204257361](图神经网络.assets/image-20201123204257361.png)

![image-20201123204531035](图神经网络.assets/image-20201123204531035.png)

### 图
七桥问题
图的表示：G =(V,E) 
图是一种统一描述复杂事物的语言

图学习：
一般深度学习：难以处理不规则数据
图学习：可以方便处理不规则数据（图）

节点级别任务---金融诈骗检测，目标检测（自动驾驶）
边级别任务---推荐系统
图级别任务---气味识别

![image-20201123205847188](图神经网络.assets/image-20201123205847188.png)

### 图学习是如何做的
1.图游走类算法（第二天内容）
2.图神经网络算法---消息传递（第三天内容）

![image-20201123210206052](图神经网络.assets/image-20201123210206052.png)

### 图学习框架---PGL

基于GAT的网页反作弊项目

![image-20201123210716375](图神经网络.assets/image-20201123210716375.png)

### 总结

![image-20201123212231233](图神经网络.assets/image-20201123212231233.png)

![image-20201123212320544](图神经网络.assets/image-20201123212320544.png)

### 番外

![image-20201123212730744](图神经网络.assets/image-20201123212730744.png)

![image-20201123213027565](图神经网络.assets/image-20201123213027565.png)

## 第二天：图游走类算法
**图游走类算法**

图游走类模型最开始参考的就是 NLP领域：**Word2vec**
### Word2vec
1.Skip Gram：根据中心词预测上下文

![image-20201124204723681](图神经网络.assets/image-20201124204723681.png)

2.Negative Sampling（负采样）

解决计算量大的问题

![image-20201124205157177](图神经网络.assets/image-20201124205157177.png)

随机采样选取负样本

### Word2vec -> 图嵌入领域
通常，图中的节点会受到其邻居的影响

### 图游走类模型 --- DeepWalk

![image-20201124205922047](图神经网络.assets/image-20201124205922047.png)

改进：

![image-20201124210407146](图神经网络.assets/image-20201124210407146.png)

### 概念
#### 同构图游走

![image-20201124210643283](图神经网络.assets/image-20201124210643283.png)

![image-20201124210826510](图神经网络.assets/image-20201124210826510.png)

![image-20201124211126690](图神经网络.assets/image-20201124211126690.png)

#### 异构图游走

异构图表示：G=(V,E,T)

方法：**metapath2vec：meta path（元路径）**

在图中选取的由节点类型构成的组合路径

* 元路径具有对称性

* 缺点：负采样的时候，没有考虑节点类型

方法改进：**metapath2vec++**

* 负采样的时候，考虑了节点类型

### 总结

![image-20201126144555053](图神经网络.assets/image-20201126144555053.png)

## 第三天：图神经网络算法(一)

![image-20201127115512879](图神经网络.assets/image-20201127115512879.png)

### GCN
#### 图像卷积与图结构卷积
图像卷积    ：将一个**像素点**周围的**像素**按照不同的**权重叠加**起来。
图结构卷积：将一个  **节点**  周围的**邻居**按照不同的**权重叠加**起来。

#### 图卷积网络计算公式

![image-20201127121112082](图神经网络.assets/image-20201127121112082.png)

![image-20201127121131437](图神经网络.assets/image-20201127121131437.png)

![image-20201127121155041](图神经网络.assets/image-20201127121155041.png)

#### 消息传递Message Passing
Send：边上的源节点，往目标节点发送特征
Recv：目标节点对收到的特征进行聚合

**衡量邻居的重要性---度**

![image-20201127121601957](图神经网络.assets/image-20201127121601957.png)

#### 节点分类任务



### GAT

![image-20201127165314750](图神经网络.assets/image-20201127165314750.png)

GCN中边的权重：
- 与节点的度相关
- 不可学习

![image-20201127165457948](图神经网络.assets/image-20201127165457948.png)

#### attention计算公式

![img](图神经网络.assets/811b7475b827490da0ed777f9c427c5c0002f26e65044bddaea81eb3bfea77ca)

### Message Passing

![image-20201127165929117](图神经网络.assets/image-20201127165929117.png)



### 总结

![image-20201127121707434](图神经网络.assets/image-20201127121707434.png)

## 第四天 图神经网络算法(二)

### 图采样算法

![image-20201126205217570](图神经网络.assets/image-20201126205217570.png)

![image-20201126205508880](图神经网络.assets/image-20201126205508880.png)

![image-20201126210643523](图神经网络.assets/image-20201126210643523.png)

### 邻居聚合

![image-20201126210942166](图神经网络.assets/image-20201126210942166.png)

![image-20201126211210927](图神经网络.assets/image-20201126211210927.png)

单射可以保证对聚合后的结果可区分

#### GIN

![image-20201126211652952](图神经网络.assets/image-20201126211652952.png)
![image-20201126211754193](图神经网络.assets/image-20201126211754193.png)

### 总结

![image-20201126212336704](图神经网络.assets/image-20201126212336704.png)
